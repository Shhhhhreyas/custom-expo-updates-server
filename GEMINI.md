# Gemini Code Understanding

This document provides a comprehensive overview of the `custom-expo-updates-server` project, generated by Gemini.

## Project Overview

This project is a monorepo containing two main components:

1.  **`expo-updates-server`**: A Next.js application that acts as a custom server for Expo updates. It serves update manifests and assets to the client application.
2.  **`expo-updates-client`**: A React Native application built with Expo, configured to receive updates from the custom server.

The purpose of this project is to provide a demonstration of how to implement a custom server that adheres to the Expo Updates protocol specification. This allows for more control over the update process compared to using the default EAS Update service.

### Technologies Used

*   **Server (`expo-updates-server`)**:
    *   Next.js
    *   TypeScript
    *   Jest for testing
*   **Client (`expo-updates-client`)**:
    *   React Native
    *   Expo
    *   TypeScript

### Architecture

The client application is configured to fetch updates from the server. When the client starts, it checks with the server for a new update. The server determines if an update is available based on the client's platform, runtime version, and current update ID.

If an update is available, the server sends a manifest to the client. The manifest contains information about the update, including a list of assets that need to be downloaded. The client then downloads the assets from the server and applies the update.

The server also supports rollbacks and code signing for added security.

## Building and Running

### Server (`expo-updates-server`)

*   **Install dependencies**: `yarn`
*   **Run in development mode**: `yarn dev`
*   **Build for production**: `yarn build`
*   **Run in production mode**: `yarn start`
*   **Run tests**: `yarn test`

### Client (`expo-updates-client`)

*   **Install dependencies**: `yarn`
*   **Run on iOS**: `yarn ios --configuration Release`
*   **Run on Android**: `yarn android --variant release`

## Development Conventions

### Publishing Updates

To publish an update, run the following command from the `expo-updates-server` directory:

```bash
yarn expo-publish
```

This script will:

1.  Export the client application using `npx expo export`.
2.  Copy the exported update to the `expo-updates-server/updates` directory.
3.  Copy the Expo config to the server.

### Rollbacks

To publish a rollback, run the following command from the `expo-updates-server` directory:

```bash
yarn expo-publish-rollback
```

### Testing

The server has a suite of tests that can be run with `yarn test`. The tests cover the manifest and asset endpoints.

### Code Style

The project uses ESLint and Prettier to enforce a consistent code style. Before committing any changes, make sure to run the linter:

```bash
yarn lint
```
